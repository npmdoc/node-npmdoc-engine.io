<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/socketio/engine.io">engine.io (v3.0.0)</a>
</h1>
<h4>The realtime engine behind Socket.IO. Provides the foundation of a bidirectional connection between client and server</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io">module engine.io</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io">
            function <span class="apidocSignatureSpan">engine.</span>io
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server">
            function <span class="apidocSignatureSpan">engine.io.</span>Server
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket">
            function <span class="apidocSignatureSpan">engine.io.</span>Socket
            <span class="apidocSignatureSpan">(id, server, transport, req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport">
            function <span class="apidocSignatureSpan">engine.io.</span>Transport
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.attach">
            function <span class="apidocSignatureSpan">engine.io.</span>attach
            <span class="apidocSignatureSpan">(server, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index">
            function <span class="apidocSignatureSpan">engine.io.</span>index
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.Server">
            function <span class="apidocSignatureSpan">engine.io.</span>io.Server
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.Socket">
            function <span class="apidocSignatureSpan">engine.io.</span>io.Socket
            <span class="apidocSignatureSpan">(id, server, transport, req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.Transport">
            function <span class="apidocSignatureSpan">engine.io.</span>io.Transport
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.index">
            function <span class="apidocSignatureSpan">engine.io.</span>io.index
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.polling">
            function <span class="apidocSignatureSpan">engine.io.</span>io.polling
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.polling_jsonp">
            function <span class="apidocSignatureSpan">engine.io.</span>io.polling_jsonp
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.polling_xhr">
            function <span class="apidocSignatureSpan">engine.io.</span>io.polling_xhr
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.io.transports.websocket">
            function <span class="apidocSignatureSpan">engine.io.</span>io.transports.websocket
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.listen">
            function <span class="apidocSignatureSpan">engine.io.</span>listen
            <span class="apidocSignatureSpan">(port, options, fn)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">engine.io.</span>protocol</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.Server.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.Socket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.Transport.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.parser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.polling.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.polling_jsonp.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.polling_xhr.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.transports</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>io.transports.websocket.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>parser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.</span>transports</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.Server">module engine.io.Server</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.Server">
            function <span class="apidocSignatureSpan">engine.io.</span>Server
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.super_">
            function <span class="apidocSignatureSpan">engine.io.Server.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.Server.</span>errorMessages</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.Server.</span>errors</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.Server.prototype">module engine.io.Server.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.attach">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>attach
            <span class="apidocSignatureSpan">(server, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.close">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>close
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.generateId">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>generateId
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.handleRequest">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>handleRequest
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.handleUpgrade">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>handleUpgrade
            <span class="apidocSignatureSpan">(req, socket, upgradeHead)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.handshake">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>handshake
            <span class="apidocSignatureSpan">(transportName, req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.init">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>init
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.onWebSocket">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>onWebSocket
            <span class="apidocSignatureSpan">(req, socket)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.prepare">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>prepare
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.upgrades">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>upgrades
            <span class="apidocSignatureSpan">(transport)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Server.prototype.verify">
            function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>verify
            <span class="apidocSignatureSpan">(req, upgrade, fn)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.Socket">module engine.io.Socket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.Socket">
            function <span class="apidocSignatureSpan">engine.io.</span>Socket
            <span class="apidocSignatureSpan">(id, server, transport, req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.super_">
            function <span class="apidocSignatureSpan">engine.io.Socket.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.Socket.prototype">module engine.io.Socket.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.clearTransport">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>clearTransport
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.close">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>close
            <span class="apidocSignatureSpan">(discard)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.closeTransport">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>closeTransport
            <span class="apidocSignatureSpan">(discard)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.flush">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>flush
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.getAvailableUpgrades">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>getAvailableUpgrades
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.maybeUpgrade">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>maybeUpgrade
            <span class="apidocSignatureSpan">(transport)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.onClose">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onClose
            <span class="apidocSignatureSpan">(reason, description)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.onError">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onError
            <span class="apidocSignatureSpan">(err)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.onOpen">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onOpen
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.onPacket">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onPacket
            <span class="apidocSignatureSpan">(packet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.send">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>send
            <span class="apidocSignatureSpan">(data, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.sendPacket">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>sendPacket
            <span class="apidocSignatureSpan">(type, data, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.setPingTimeout">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>setPingTimeout
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.setTransport">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>setTransport
            <span class="apidocSignatureSpan">(transport)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.setupSendCallback">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>setupSendCallback
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Socket.prototype.write">
            function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>write
            <span class="apidocSignatureSpan">(data, options, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.Transport">module engine.io.Transport</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.Transport">
            function <span class="apidocSignatureSpan">engine.io.</span>Transport
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.super_">
            function <span class="apidocSignatureSpan">engine.io.Transport.</span>super_
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.Transport.prototype">module engine.io.Transport.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.close">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>close
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.discard">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>discard
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.onClose">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onClose
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.onData">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.onError">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onError
            <span class="apidocSignatureSpan">(msg, desc)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.onPacket">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onPacket
            <span class="apidocSignatureSpan">(packet)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.Transport.prototype.onRequest">
            function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onRequest
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.index">module engine.io.index</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index.index">
            function <span class="apidocSignatureSpan">engine.io.</span>index
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index.Server">
            function <span class="apidocSignatureSpan">engine.io.index.</span>Server
            <span class="apidocSignatureSpan">(opts)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index.Socket">
            function <span class="apidocSignatureSpan">engine.io.index.</span>Socket
            <span class="apidocSignatureSpan">(id, server, transport, req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index.Transport">
            function <span class="apidocSignatureSpan">engine.io.index.</span>Transport
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index.attach">
            function <span class="apidocSignatureSpan">engine.io.index.</span>attach
            <span class="apidocSignatureSpan">(server, options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.index.listen">
            function <span class="apidocSignatureSpan">engine.io.index.</span>listen
            <span class="apidocSignatureSpan">(port, options, fn)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">engine.io.index.</span>protocol</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.index.</span>parser</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.index.</span>transports</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.parser">module engine.io.parser</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.decodeBase64Packet">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>decodeBase64Packet
            <span class="apidocSignatureSpan">(msg, binaryType)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.decodePacket">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>decodePacket
            <span class="apidocSignatureSpan">(data, binaryType, utf8decode)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.decodePayload">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>decodePayload
            <span class="apidocSignatureSpan">(data, binaryType, utf8decode, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.decodePayloadAsBinary">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>decodePayloadAsBinary
            <span class="apidocSignatureSpan">(data, binaryType, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.encodeBase64Packet">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>encodeBase64Packet
            <span class="apidocSignatureSpan">(packet, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.encodePacket">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>encodePacket
            <span class="apidocSignatureSpan">(packet, supportsBinary, utf8encode, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.encodePayload">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>encodePayload
            <span class="apidocSignatureSpan">(packets, supportsBinary, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.parser.encodePayloadAsBinary">
            function <span class="apidocSignatureSpan">engine.io.parser.</span>encodePayloadAsBinary
            <span class="apidocSignatureSpan">(packets, callback)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">engine.io.parser.</span>protocol</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">engine.io.parser.</span>packets</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.polling">module engine.io.polling</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.polling">
            function <span class="apidocSignatureSpan">engine.io.</span>polling
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.super_">
            function <span class="apidocSignatureSpan">engine.io.polling.</span>super_
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.polling.prototype">module engine.io.polling.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.compress">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>compress
            <span class="apidocSignatureSpan">(data, encoding, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.doClose">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>doClose
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.doWrite">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>doWrite
            <span class="apidocSignatureSpan">(data, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.headers">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>headers
            <span class="apidocSignatureSpan">(req, headers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.onClose">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onClose
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.onData">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.onDataRequest">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onDataRequest
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.onPollRequest">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onPollRequest
            <span class="apidocSignatureSpan">(req, res)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.onRequest">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onRequest
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.send">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>send
            <span class="apidocSignatureSpan">(packets)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling.prototype.write">
            function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>write
            <span class="apidocSignatureSpan">(data, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>name</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.polling_jsonp">module engine.io.polling_jsonp</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_jsonp.polling_jsonp">
            function <span class="apidocSignatureSpan">engine.io.</span>polling_jsonp
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_jsonp.super_">
            function <span class="apidocSignatureSpan">engine.io.polling_jsonp.</span>super_
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.polling_jsonp.prototype">module engine.io.polling_jsonp.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_jsonp.prototype.doWrite">
            function <span class="apidocSignatureSpan">engine.io.polling_jsonp.prototype.</span>doWrite
            <span class="apidocSignatureSpan">(data, options, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_jsonp.prototype.onData">
            function <span class="apidocSignatureSpan">engine.io.polling_jsonp.prototype.</span>onData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.polling_xhr">module engine.io.polling_xhr</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_xhr.polling_xhr">
            function <span class="apidocSignatureSpan">engine.io.</span>polling_xhr
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_xhr.super_">
            function <span class="apidocSignatureSpan">engine.io.polling_xhr.</span>super_
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.polling_xhr.prototype">module engine.io.polling_xhr.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_xhr.prototype.headers">
            function <span class="apidocSignatureSpan">engine.io.polling_xhr.prototype.</span>headers
            <span class="apidocSignatureSpan">(req, headers)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.polling_xhr.prototype.onRequest">
            function <span class="apidocSignatureSpan">engine.io.polling_xhr.prototype.</span>onRequest
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.transports">module engine.io.transports</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.polling">
            function <span class="apidocSignatureSpan">engine.io.transports.</span>polling
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.websocket">
            function <span class="apidocSignatureSpan">engine.io.transports.</span>websocket
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.transports.websocket">module engine.io.transports.websocket</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.websocket.websocket">
            function <span class="apidocSignatureSpan">engine.io.transports.</span>websocket
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.websocket.super_">
            function <span class="apidocSignatureSpan">engine.io.transports.websocket.</span>super_
            <span class="apidocSignatureSpan">(req)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.engine.io.transports.websocket.prototype">module engine.io.transports.websocket.prototype</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>handlesUpgrades</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>supportsFraming</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.websocket.prototype.doClose">
            function <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>doClose
            <span class="apidocSignatureSpan">(fn)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.websocket.prototype.onData">
            function <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>onData
            <span class="apidocSignatureSpan">(data)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.engine.io.transports.websocket.prototype.send">
            function <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>send
            <span class="apidocSignatureSpan">(packets)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>name</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io" id="apidoc.module.engine.io">module engine.io</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.io" id="apidoc.element.engine.io.io">
        function <span class="apidocSignatureSpan">engine.</span>io
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io = function () {
  // backwards compatible use as `.attach`
  // if first argument is an http server
  if (arguments.length &amp;&amp; arguments[0] instanceof http.Server) {
    return attach.apply(this, arguments);
  }

  // if first argument is not an http server, then just make a regular eio server
  return exports.Server.apply(null, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server" id="apidoc.element.engine.io.Server">
        function <span class="apidocSignatureSpan">engine.io.</span>Server
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Server(opts) {
  if (!(this instanceof Server)) {
    return new Server(opts);
  }

  this.clients = {};
  this.clientsCount = 0;

  opts = opts || {};

  this.wsEngine = opts.wsEngine || process.env.EIO_WS_ENGINE || 'uws';
  this.pingTimeout = opts.pingTimeout || 60000;
  this.pingInterval = opts.pingInterval || 25000;
  this.upgradeTimeout = opts.upgradeTimeout || 10000;
  this.maxHttpBufferSize = opts.maxHttpBufferSize || 10E7;
  this.transports = opts.transports || Object.keys(transports);
  this.allowUpgrades = false !== opts.allowUpgrades;
  this.allowRequest = opts.allowRequest;
  this.cookie = false !== opts.cookie ? (opts.cookie || 'io') : false;
  this.cookiePath = false !== opts.cookiePath ? (opts.cookiePath || '/') : false;
  this.cookieHttpOnly = false !== opts.cookieHttpOnly;
  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || true) : false;
  this.httpCompression = false !== opts.httpCompression ? (opts.httpCompression || {}) : false;
  this.initialPacket = opts.initialPacket;

  var self = this;

  // initialize compression options
  ['perMessageDeflate', 'httpCompression'].forEach(function (type) {
    var compression = self[type];
    if (true === compression) self[type] = compression = {};
    if (compression &amp;&amp; null == compression.threshold) {
      compression.threshold = 1024;
    }
  });

  this.init();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

#### (C) Passing in requests

```js
var engine = require('engine.io');
var server = new engine.<span class="apidocCodeKeywordSpan">Server</span>();

server.on('connection', function(socket){
  socket.send('hi');
});

// â€¦
httpServer.on('upgrade', function(req, socket, head){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket" id="apidoc.element.engine.io.Socket">
        function <span class="apidocSignatureSpan">engine.io.</span>Socket
        <span class="apidocSignatureSpan">(id, server, transport, req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Socket(id, server, transport, req) {
  this.id = id;
  this.server = server;
  this.upgrading = false;
  this.upgraded = false;
  this.readyState = 'opening';
  this.writeBuffer = [];
  this.packetsFn = [];
  this.sentCallbackFn = [];
  this.cleanupFn = [];
  this.request = req;

  // Cache IP since it might not be in the req later
  this.remoteAddress = req.connection.remoteAddress;

  this.checkIntervalTimer = null;
  this.upgradeTimeoutTimer = null;
  this.pingTimeoutTimer = null;

  this.setTransport(transport);
  this.onOpen();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

### Client

```html
&lt;script src="/path/to/engine.io.js"&gt;&lt;/script&gt;
&lt;script&gt;
  var socket = new eio.<span class="apidocCodeKeywordSpan">Socket</span>('ws://localhost/');
  socket.on('open', function(){
    socket.on('message', function(data){});
    socket.on('close', function(){});
  });
&lt;/script&gt;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport" id="apidoc.element.engine.io.Transport">
        function <span class="apidocSignatureSpan">engine.io.</span>Transport
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Transport(req) {
  this.readyState = 'open';
  this.discarded = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.attach" id="apidoc.element.engine.io.attach">
        function <span class="apidocSignatureSpan">engine.io.</span>attach
        <span class="apidocSignatureSpan">(server, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function attach(server, options) {
  var engine = new exports.Server(options);
  engine.attach(server, options);
  return engine;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

#### (B) Intercepting requests for a http.Server

```js
var engine = require('engine.io');
var http = require('http').createServer().listen(3000);
var server = engine.<span class="apidocCodeKeywordSpan">attach</span>(http);

server.on('connection', function (socket) {
  socket.on('message', function(data){ });
  socket.on('close', function(){ });
});
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.index" id="apidoc.element.engine.io.index">
        function <span class="apidocSignatureSpan">engine.io.</span>index
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">index = function () {
  // backwards compatible use as `.attach`
  // if first argument is an http server
  if (arguments.length &amp;&amp; arguments[0] instanceof http.Server) {
    return attach.apply(this, arguments);
  }

  // if first argument is not an http server, then just make a regular eio server
  return exports.Server.apply(null, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.Server" id="apidoc.element.engine.io.io.Server">
        function <span class="apidocSignatureSpan">engine.io.</span>io.Server
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Server(opts) {
  if (!(this instanceof Server)) {
    return new Server(opts);
  }

  this.clients = {};
  this.clientsCount = 0;

  opts = opts || {};

  this.wsEngine = opts.wsEngine || process.env.EIO_WS_ENGINE || 'uws';
  this.pingTimeout = opts.pingTimeout || 60000;
  this.pingInterval = opts.pingInterval || 25000;
  this.upgradeTimeout = opts.upgradeTimeout || 10000;
  this.maxHttpBufferSize = opts.maxHttpBufferSize || 10E7;
  this.transports = opts.transports || Object.keys(transports);
  this.allowUpgrades = false !== opts.allowUpgrades;
  this.allowRequest = opts.allowRequest;
  this.cookie = false !== opts.cookie ? (opts.cookie || 'io') : false;
  this.cookiePath = false !== opts.cookiePath ? (opts.cookiePath || '/') : false;
  this.cookieHttpOnly = false !== opts.cookieHttpOnly;
  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || true) : false;
  this.httpCompression = false !== opts.httpCompression ? (opts.httpCompression || {}) : false;
  this.initialPacket = opts.initialPacket;

  var self = this;

  // initialize compression options
  ['perMessageDeflate', 'httpCompression'].forEach(function (type) {
    var compression = self[type];
    if (true === compression) self[type] = compression = {};
    if (compression &amp;&amp; null == compression.threshold) {
      compression.threshold = 1024;
    }
  });

  this.init();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.Socket" id="apidoc.element.engine.io.io.Socket">
        function <span class="apidocSignatureSpan">engine.io.</span>io.Socket
        <span class="apidocSignatureSpan">(id, server, transport, req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Socket(id, server, transport, req) {
  this.id = id;
  this.server = server;
  this.upgrading = false;
  this.upgraded = false;
  this.readyState = 'opening';
  this.writeBuffer = [];
  this.packetsFn = [];
  this.sentCallbackFn = [];
  this.cleanupFn = [];
  this.request = req;

  // Cache IP since it might not be in the req later
  this.remoteAddress = req.connection.remoteAddress;

  this.checkIntervalTimer = null;
  this.upgradeTimeoutTimer = null;
  this.pingTimeoutTimer = null;

  this.setTransport(transport);
  this.onOpen();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.Transport" id="apidoc.element.engine.io.io.Transport">
        function <span class="apidocSignatureSpan">engine.io.</span>io.Transport
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Transport(req) {
  this.readyState = 'open';
  this.discarded = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.index" id="apidoc.element.engine.io.io.index">
        function <span class="apidocSignatureSpan">engine.io.</span>io.index
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">io.index = function () {
  // backwards compatible use as `.attach`
  // if first argument is an http server
  if (arguments.length &amp;&amp; arguments[0] instanceof http.Server) {
    return attach.apply(this, arguments);
  }

  // if first argument is not an http server, then just make a regular eio server
  return exports.Server.apply(null, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.polling" id="apidoc.element.engine.io.io.polling">
        function <span class="apidocSignatureSpan">engine.io.</span>io.polling
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Polling(req) {
  Transport.call(this, req);

  this.closeTimeout = 30 * 1000;
  this.maxHttpBufferSize = null;
  this.httpCompression = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.polling_jsonp" id="apidoc.element.engine.io.io.polling_jsonp">
        function <span class="apidocSignatureSpan">engine.io.</span>io.polling_jsonp
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JSONP(req) {
  Polling.call(this, req);

  this.head = '___eio[' + (req._query.j || '').replace(/[^0-9]/g, '') + '](';
  this.foot = ');';
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.polling_xhr" id="apidoc.element.engine.io.io.polling_xhr">
        function <span class="apidocSignatureSpan">engine.io.</span>io.polling_xhr
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function XHR(req) {
  Polling.call(this, req);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.io.transports.websocket" id="apidoc.element.engine.io.io.transports.websocket">
        function <span class="apidocSignatureSpan">engine.io.</span>io.transports.websocket
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function WebSocket(req) {
  Transport.call(this, req);
  var self = this;
  this.socket = req.websocket;
  this.socket.on('message', this.onData.bind(this));
  this.socket.once('close', this.onClose.bind(this));
  this.socket.on('error', this.onError.bind(this));
  this.socket.on('headers', onHeaders);
  this.writable = true;
  this.perMessageDeflate = null;

  function onHeaders (headers) {
    self.emit('headers', headers);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.listen" id="apidoc.element.engine.io.listen">
        function <span class="apidocSignatureSpan">engine.io.</span>listen
        <span class="apidocSignatureSpan">(port, options, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listen(port, options, fn) {
  if ('function' === typeof options) {
    fn = options;
    options = {};
  }

  var server = http.createServer(function (req, res) {
    res.writeHead(501);
    res.end('Not Implemented');
  });

  // create engine server
  var engine = exports.attach(server, options);
  engine.httpServer = server;

  server.listen(port, fn);

  return engine;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

### Server

#### (A) Listening on a port

```js
var engine = require('engine.io');
var server = engine.<span class="apidocCodeKeywordSpan">listen</span>(80);

server.on('connection', function(socket){
  socket.send('utf 8 string');
  socket.send(new Buffer([0, 1, 2, 3, 4, 5])); // binary data
});
```
...</pre></li>
    </ul>


























</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.Server" id="apidoc.module.engine.io.Server">module engine.io.Server</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.Server.Server" id="apidoc.element.engine.io.Server.Server">
        function <span class="apidocSignatureSpan">engine.io.</span>Server
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Server(opts) {
  if (!(this instanceof Server)) {
    return new Server(opts);
  }

  this.clients = {};
  this.clientsCount = 0;

  opts = opts || {};

  this.wsEngine = opts.wsEngine || process.env.EIO_WS_ENGINE || 'uws';
  this.pingTimeout = opts.pingTimeout || 60000;
  this.pingInterval = opts.pingInterval || 25000;
  this.upgradeTimeout = opts.upgradeTimeout || 10000;
  this.maxHttpBufferSize = opts.maxHttpBufferSize || 10E7;
  this.transports = opts.transports || Object.keys(transports);
  this.allowUpgrades = false !== opts.allowUpgrades;
  this.allowRequest = opts.allowRequest;
  this.cookie = false !== opts.cookie ? (opts.cookie || 'io') : false;
  this.cookiePath = false !== opts.cookiePath ? (opts.cookiePath || '/') : false;
  this.cookieHttpOnly = false !== opts.cookieHttpOnly;
  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || true) : false;
  this.httpCompression = false !== opts.httpCompression ? (opts.httpCompression || {}) : false;
  this.initialPacket = opts.initialPacket;

  var self = this;

  // initialize compression options
  ['perMessageDeflate', 'httpCompression'].forEach(function (type) {
    var compression = self[type];
    if (true === compression) self[type] = compression = {};
    if (compression &amp;&amp; null == compression.threshold) {
      compression.threshold = 1024;
    }
  });

  this.init();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

#### (C) Passing in requests

```js
var engine = require('engine.io');
var server = new engine.<span class="apidocCodeKeywordSpan">Server</span>();

server.on('connection', function(socket){
  socket.send('hi');
});

// â€¦
httpServer.on('upgrade', function(req, socket, head){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.super_" id="apidoc.element.engine.io.Server.super_">
        function <span class="apidocSignatureSpan">engine.io.Server.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.Server.prototype" id="apidoc.module.engine.io.Server.prototype">module engine.io.Server.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.attach" id="apidoc.element.engine.io.Server.prototype.attach">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>attach
        <span class="apidocSignatureSpan">(server, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">attach = function (server, options) {
  var self = this;
  options = options || {};
  var path = (options.path || '/engine.io').replace(/\/$/, '');

  var destroyUpgradeTimeout = options.destroyUpgradeTimeout || 1000;

  // normalize path
  path += '/';

  function check (req) {
    if ('OPTIONS' === req.method &amp;&amp; false === options.handlePreflightRequest) {
      return false;
    }
    return path === req.url.substr(0, path.length);
  }

  // cache and clean up listeners
  var listeners = server.listeners('request').slice(0);
  server.removeAllListeners('request');
  server.on('close', self.close.bind(self));
  server.on('listening', self.init.bind(self));

  // add request handler
  server.on('request', function (req, res) {
    if (check(req)) {
      debug('intercepting request for path "%s"', path);
      if ('OPTIONS' === req.method &amp;&amp; 'function' === typeof options.handlePreflightRequest) {
        options.handlePreflightRequest.call(server, req, res);
      } else {
        self.handleRequest(req, res);
      }
    } else {
      for (var i = 0, l = listeners.length; i &lt; l; i++) {
        listeners[i].call(server, req, res);
      }
    }
  });

  if (~self.transports.indexOf('websocket')) {
    server.on('upgrade', function (req, socket, head) {
      if (check(req)) {
        self.handleUpgrade(req, socket, head);
      } else if (false !== options.destroyUpgrade) {
        // default node behavior is to disconnect when no handlers
        // but by adding a handler, we prevent that
        // and if no eio thing handles the upgrade
        // then the socket needs to die!
        setTimeout(function () {
          if (socket.writable &amp;&amp; socket.bytesWritten &lt;= 0) {
            return socket.end();
          }
        }, destroyUpgradeTimeout);
      }
    });
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

#### (B) Intercepting requests for a http.Server

```js
var engine = require('engine.io');
var http = require('http').createServer().listen(3000);
var server = engine.<span class="apidocCodeKeywordSpan">attach</span>(http);

server.on('connection', function (socket) {
  socket.on('message', function(data){ });
  socket.on('close', function(){ });
});
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.close" id="apidoc.element.engine.io.Server.prototype.close">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>close
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function () {
  debug('closing all open clients');
  for (var i in this.clients) {
    if (this.clients.hasOwnProperty(i)) {
      this.clients[i].close(true);
    }
  }
  if (this.ws) {
    debug('closing webSocketServer');
    this.ws.close();
    // don't delete this.ws because it can be used again if the http server starts listening again
  }
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.generateId" id="apidoc.element.engine.io.Server.prototype.generateId">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>generateId
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">generateId = function (req) {
  return base64id.generateId();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.handleRequest" id="apidoc.element.engine.io.Server.prototype.handleRequest">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>handleRequest
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handleRequest = function (req, res) {
  debug('handling "%s" http request "%s"', req.method, req.url);
  this.prepare(req);
  req.res = res;

  var self = this;
  this.verify(req, false, function (err, success) {
    if (!success) {
      sendErrorMessage(req, res, err);
      return;
    }

    if (req._query.sid) {
      debug('setting new request for existing client');
      self.clients[req._query.sid].transport.onRequest(req);
    } else {
      self.handshake(req._query.transport, req);
    }
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});

// â€¦
httpServer.on('upgrade', function(req, socket, head){
  server.handleUpgrade(req, socket, head);
});
httpServer.on('request', function(req, res){
  server.<span class="apidocCodeKeywordSpan">handleRequest</span>(req, res);
});
```

### Client

```html
&lt;script src="/path/to/engine.io.js"&gt;&lt;/script&gt;
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.handleUpgrade" id="apidoc.element.engine.io.Server.prototype.handleUpgrade">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>handleUpgrade
        <span class="apidocSignatureSpan">(req, socket, upgradeHead)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handleUpgrade = function (req, socket, upgradeHead) {
  this.prepare(req);

  var self = this;
  this.verify(req, true, function (err, success) {
    if (!success) {
      abortConnection(socket, err);
      return;
    }

    var head = new Buffer(upgradeHead.length);
    upgradeHead.copy(head);
    upgradeHead = null;

    // delegate to ws
    self.ws.handleUpgrade(req, socket, head, function (conn) {
      self.onWebSocket(req, conn);
    });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

server.on('connection', function(socket){
  socket.send('hi');
});

// â€¦
httpServer.on('upgrade', function(req, socket, head){
  server.<span class="apidocCodeKeywordSpan">handleUpgrade</span>(req, socket, head);
});
httpServer.on('request', function(req, res){
  server.handleRequest(req, res);
});
```

### Client
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.handshake" id="apidoc.element.engine.io.Server.prototype.handshake">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>handshake
        <span class="apidocSignatureSpan">(transportName, req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">handshake = function (transportName, req) {
  var id = this.generateId(req);

  debug('handshaking client "%s"', id);

  try {
    var transport = new transports[transportName](req);
    if ('polling' === transportName) {
      transport.maxHttpBufferSize = this.maxHttpBufferSize;
      transport.httpCompression = this.httpCompression;
    } else if ('websocket' === transportName) {
      transport.perMessageDeflate = this.perMessageDeflate;
    }

    if (req._query &amp;&amp; req._query.b64) {
      transport.supportsBinary = false;
    } else {
      transport.supportsBinary = true;
    }
  } catch (e) {
    sendErrorMessage(req, req.res, Server.errors.BAD_REQUEST);
    return;
  }
  var socket = new Socket(id, this, transport, req);
  var self = this;

  if (false !== this.cookie) {
    transport.on('headers', function (headers) {
      headers['Set-Cookie'] = cookieMod.serialize(self.cookie, id,
        {
          path: self.cookiePath,
          httpOnly: self.cookiePath ? self.cookieHttpOnly : false
        });
    });
  }

  transport.onRequest(req);

  this.clients[id] = socket;
  this.clientsCount++;

  socket.once('close', function () {
    delete self.clients[id];
    self.clientsCount--;
  });

  this.emit('connection', socket);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.init" id="apidoc.element.engine.io.Server.prototype.init">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>init
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">init = function () {
  if (!~this.transports.indexOf('websocket')) return;

  if (this.ws) this.ws.close();

  var wsModule;
  try {
    wsModule = require(this.wsEngine);
  } catch (ex) {
    this.wsEngine = 'ws';
    // keep require('ws') as separate expression for packers (browserify, etc)
    wsModule = require('ws');
  }
  this.ws = new wsModule.Server({
    noServer: true,
    clientTracking: false,
    perMessageDeflate: this.perMessageDeflate,
    maxPayload: this.maxHttpBufferSize
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.onWebSocket" id="apidoc.element.engine.io.Server.prototype.onWebSocket">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>onWebSocket
        <span class="apidocSignatureSpan">(req, socket)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onWebSocket = function (req, socket) {
  socket.on('error', onUpgradeError);

  if (!transports[req._query.transport].prototype.handlesUpgrades) {
    debug('transport doesnt handle upgraded requests');
    socket.close();
    return;
  }

  // get client id
  var id = req._query.sid;

  // keep a reference to the ws.Socket
  req.websocket = socket;

  if (id) {
    var client = this.clients[id];
    if (!client) {
      debug('upgrade attempt for closed client');
      socket.close();
    } else if (client.upgrading) {
      debug('transport has already been trying to upgrade');
      socket.close();
    } else if (client.upgraded) {
      debug('transport had already been upgraded');
      socket.close();
    } else {
      debug('upgrading existing transport');

      // transport error handling takes over
      socket.removeListener('error', onUpgradeError);

      var transport = new transports[req._query.transport](req);
      if (req._query &amp;&amp; req._query.b64) {
        transport.supportsBinary = false;
      } else {
        transport.supportsBinary = true;
      }
      transport.perMessageDeflate = this.perMessageDeflate;
      client.maybeUpgrade(transport);
    }
  } else {
    // transport error handling takes over
    socket.removeListener('error', onUpgradeError);

    this.handshake(req._query.transport, req);
  }

  function onUpgradeError () {
    debug('websocket error before upgrade');
    // socket.close() not needed
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.prepare" id="apidoc.element.engine.io.Server.prototype.prepare">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>prepare
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">prepare = function (req) {
  // try to leverage pre-existing `req._query` (e.g: from connect)
  if (!req._query) {
    req._query = ~req.url.indexOf('?') ? qs.parse(parse(req.url).query) : {};
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.upgrades" id="apidoc.element.engine.io.Server.prototype.upgrades">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>upgrades
        <span class="apidocSignatureSpan">(transport)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">upgrades = function (transport) {
  if (!this.allowUpgrades) return [];
  return transports[transport].upgradesTo || [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Server.prototype.verify" id="apidoc.element.engine.io.Server.prototype.verify">
        function <span class="apidocSignatureSpan">engine.io.Server.prototype.</span>verify
        <span class="apidocSignatureSpan">(req, upgrade, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">verify = function (req, upgrade, fn) {
  // transport check
  var transport = req._query.transport;
  if (!~this.transports.indexOf(transport)) {
    debug('unknown transport "%s"', transport);
    return fn(Server.errors.UNKNOWN_TRANSPORT, false);
  }

  // sid check
  var sid = req._query.sid;
  if (sid) {
    if (!this.clients.hasOwnProperty(sid)) {
      return fn(Server.errors.UNKNOWN_SID, false);
    }
    if (!upgrade &amp;&amp; this.clients[sid].transport.name !== transport) {
      debug('bad request: unexpected transport without upgrade');
      return fn(Server.errors.BAD_REQUEST, false);
    }
  } else {
    // handshake is GET only
    if ('GET' !== req.method) return fn(Server.errors.BAD_HANDSHAKE_METHOD, false);
    if (!this.allowRequest) return fn(null, true);
    return this.allowRequest(req, fn);
  }

  fn(null, true);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.Socket" id="apidoc.module.engine.io.Socket">module engine.io.Socket</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.Socket.Socket" id="apidoc.element.engine.io.Socket.Socket">
        function <span class="apidocSignatureSpan">engine.io.</span>Socket
        <span class="apidocSignatureSpan">(id, server, transport, req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Socket(id, server, transport, req) {
  this.id = id;
  this.server = server;
  this.upgrading = false;
  this.upgraded = false;
  this.readyState = 'opening';
  this.writeBuffer = [];
  this.packetsFn = [];
  this.sentCallbackFn = [];
  this.cleanupFn = [];
  this.request = req;

  // Cache IP since it might not be in the req later
  this.remoteAddress = req.connection.remoteAddress;

  this.checkIntervalTimer = null;
  this.upgradeTimeoutTimer = null;
  this.pingTimeoutTimer = null;

  this.setTransport(transport);
  this.onOpen();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

### Client

```html
&lt;script src="/path/to/engine.io.js"&gt;&lt;/script&gt;
&lt;script&gt;
  var socket = new eio.<span class="apidocCodeKeywordSpan">Socket</span>('ws://localhost/');
  socket.on('open', function(){
    socket.on('message', function(data){});
    socket.on('close', function(){});
  });
&lt;/script&gt;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.super_" id="apidoc.element.engine.io.Socket.super_">
        function <span class="apidocSignatureSpan">engine.io.Socket.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.Socket.prototype" id="apidoc.module.engine.io.Socket.prototype">module engine.io.Socket.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.clearTransport" id="apidoc.element.engine.io.Socket.prototype.clearTransport">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>clearTransport
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearTransport = function () {
  var cleanup;

  var toCleanUp = this.cleanupFn.length;

  for (var i = 0; i &lt; toCleanUp; i++) {
    cleanup = this.cleanupFn.shift();
    cleanup();
  }

  // silence further transport errors and prevent uncaught exceptions
  this.transport.on('error', function () {
    debug('error triggered by discarded transport');
  });

  // ensure transport won't stay open
  this.transport.close();

  clearTimeout(this.pingTimeoutTimer);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.close" id="apidoc.element.engine.io.Socket.prototype.close">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>close
        <span class="apidocSignatureSpan">(discard)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function (discard) {
  if ('open' !== this.readyState) return;

  this.readyState = 'closing';

  if (this.writeBuffer.length) {
    this.once('drain', this.closeTransport.bind(this, discard));
    return;
  }

  this.closeTransport(discard);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.closeTransport" id="apidoc.element.engine.io.Socket.prototype.closeTransport">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>closeTransport
        <span class="apidocSignatureSpan">(discard)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">closeTransport = function (discard) {
  if (discard) this.transport.discard();
  this.transport.close(this.onClose.bind(this, 'forced close'));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.flush" id="apidoc.element.engine.io.Socket.prototype.flush">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>flush
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">flush = function () {
  if ('closed' !== this.readyState &amp;&amp;
                this.transport.writable &amp;&amp;
                this.writeBuffer.length) {
    debug('flushing buffer to transport');
    this.emit('flush', this.writeBuffer);
    this.server.emit('flush', this, this.writeBuffer);
    var wbuf = this.writeBuffer;
    this.writeBuffer = [];
    if (!this.transport.supportsFraming) {
      this.sentCallbackFn.push(this.packetsFn);
    } else {
      this.sentCallbackFn.push.apply(this.sentCallbackFn, this.packetsFn);
    }
    this.packetsFn = [];
    this.transport.send(wbuf);
    this.emit('drain');
    this.server.emit('drain', this);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.getAvailableUpgrades" id="apidoc.element.engine.io.Socket.prototype.getAvailableUpgrades">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>getAvailableUpgrades
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAvailableUpgrades = function () {
  var availableUpgrades = [];
  var allUpgrades = this.server.upgrades(this.transport.name);
  for (var i = 0, l = allUpgrades.length; i &lt; l; ++i) {
    var upg = allUpgrades[i];
    if (this.server.transports.indexOf(upg) !== -1) {
      availableUpgrades.push(upg);
    }
  }
  return availableUpgrades;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.maybeUpgrade" id="apidoc.element.engine.io.Socket.prototype.maybeUpgrade">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>maybeUpgrade
        <span class="apidocSignatureSpan">(transport)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">maybeUpgrade = function (transport) {
  debug('might upgrade socket transport from "%s" to "%s"'
    , this.transport.name, transport.name);

  this.upgrading = true;

  var self = this;

  // set transport upgrade timer
  self.upgradeTimeoutTimer = setTimeout(function () {
    debug('client did not complete upgrade - closing transport');
    cleanup();
    if ('open' === transport.readyState) {
      transport.close();
    }
  }, this.server.upgradeTimeout);

  function onPacket (packet) {
    if ('ping' === packet.type &amp;&amp; 'probe' === packet.data) {
      transport.send([{ type: 'pong', data: 'probe' }]);
      self.emit('upgrading', transport);
      clearInterval(self.checkIntervalTimer);
      self.checkIntervalTimer = setInterval(check, 100);
    } else if ('upgrade' === packet.type &amp;&amp; self.readyState !== 'closed') {
      debug('got upgrade packet - upgrading');
      cleanup();
      self.transport.discard();
      self.upgraded = true;
      self.clearTransport();
      self.setTransport(transport);
      self.emit('upgrade', transport);
      self.setPingTimeout();
      self.flush();
      if (self.readyState === 'closing') {
        transport.close(function () {
          self.onClose('forced close');
        });
      }
    } else {
      cleanup();
      transport.close();
    }
  }

  // we force a polling cycle to ensure a fast upgrade
  function check () {
    if ('polling' === self.transport.name &amp;&amp; self.transport.writable) {
      debug('writing a noop packet to polling for fast upgrade');
      self.transport.send([{ type: 'noop' }]);
    }
  }

  function cleanup () {
    self.upgrading = false;

    clearInterval(self.checkIntervalTimer);
    self.checkIntervalTimer = null;

    clearTimeout(self.upgradeTimeoutTimer);
    self.upgradeTimeoutTimer = null;

    transport.removeListener('packet', onPacket);
    transport.removeListener('close', onTransportClose);
    transport.removeListener('error', onError);
    self.removeListener('close', onClose);
  }

  function onError (err) {
    debug('client did not complete upgrade - %s', err);
    cleanup();
    transport.close();
    transport = null;
  }

  function onTransportClose () {
    onError('transport closed');
  }

  function onClose () {
    onError('socket closed');
  }

  transport.on('packet', onPacket);
  transport.once('close', onTransportClose);
  transport.once('error', onError);

  self.once('close', onClose);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.onClose" id="apidoc.element.engine.io.Socket.prototype.onClose">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onClose
        <span class="apidocSignatureSpan">(reason, description)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onClose = function (reason, description) {
  if ('closed' !== this.readyState) {
    this.readyState = 'closed';
    clearTimeout(this.pingTimeoutTimer);
    clearInterval(this.checkIntervalTimer);
    this.checkIntervalTimer = null;
    clearTimeout(this.upgradeTimeoutTimer);
    var self = this;
    // clean writeBuffer in next tick, so developers can still
    // grab the writeBuffer on 'close' event
    process.nextTick(function () {
      self.writeBuffer = [];
    });
    this.packetsFn = [];
    this.sentCallbackFn = [];
    this.clearTransport();
    this.emit('close', reason, description);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Polling.prototype.onData = function (data) {
debug('received "%s"', data);
var self = this;
var callback = function (packet) {
  if ('close' === packet.type) {
    debug('got xhr close packet');
    self.<span class="apidocCodeKeywordSpan">onClose</span>();
    return false;
  }

  self.onPacket(packet);
};

parser.decodePayload(data, callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.onError" id="apidoc.element.engine.io.Socket.prototype.onError">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onError
        <span class="apidocSignatureSpan">(err)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onError = function (err) {
  debug('transport error');
  this.onClose('transport error', err);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api private
 */

Polling.prototype.onPollRequest = function (req, res) {
if (this.req) {
  debug('request overlap');
  // assert: this.res, '.req and .res should be (un)set together'
  this.<span class="apidocCodeKeywordSpan">onError</span>('overlap from client');
  res.writeHead(500);
  res.end();
  return;
}

debug('setting request');
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.onOpen" id="apidoc.element.engine.io.Socket.prototype.onOpen">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onOpen
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onOpen = function () {
  this.readyState = 'open';

  // sends an `open` packet
  this.transport.sid = this.id;
  this.sendPacket('open', JSON.stringify({
    sid: this.id,
    upgrades: this.getAvailableUpgrades(),
    pingInterval: this.server.pingInterval,
    pingTimeout: this.server.pingTimeout
  }));

  if (this.server.initialPacket) {
    this.sendPacket('message', this.server.initialPacket);
  }

  this.emit('open');
  this.setPingTimeout();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.onPacket" id="apidoc.element.engine.io.Socket.prototype.onPacket">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>onPacket
        <span class="apidocSignatureSpan">(packet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onPacket = function (packet) {
  if ('open' === this.readyState) {
    // export packet event
    debug('packet');
    this.emit('packet', packet);

    // Reset ping timeout on any packet, incoming data is a good sign of
    // other side's liveness
    this.setPingTimeout();

    switch (packet.type) {

      case 'ping':
        debug('got ping');
        this.sendPacket('pong');
        this.emit('heartbeat');
        break;

      case 'error':
        this.onClose('parse error');
        break;

      case 'message':
        this.emit('data', packet.data);
        this.emit('message', packet.data);
        break;
    }
  } else {
    debug('packet received with closed socket');
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 var callback = function (packet) {
   if ('close' === packet.type) {
     debug('got xhr close packet');
     self.onClose();
     return false;
   }

   self.<span class="apidocCodeKeywordSpan">onPacket</span>(packet);
 };

 parser.decodePayload(data, callback);
};

/**
* Overrides onClose.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.send" id="apidoc.element.engine.io.Socket.prototype.send">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>send
        <span class="apidocSignatureSpan">(data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (data, options, callback) {
  this.sendPacket('message', data, options, callback);
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
#### (A) Listening on a port

```js
var engine = require('engine.io');
var server = engine.listen(80);

server.on('connection', function(socket){
  socket.<span class="apidocCodeKeywordSpan">send</span>('utf 8 string');
  socket.send(new Buffer([0, 1, 2, 3, 4, 5])); // binary data
});
```

#### (B) Intercepting requests for a http.Server

```js
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.sendPacket" id="apidoc.element.engine.io.Socket.prototype.sendPacket">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>sendPacket
        <span class="apidocSignatureSpan">(type, data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">sendPacket = function (type, data, options, callback) {
  if ('function' === typeof options) {
    callback = options;
    options = null;
  }

  options = options || {};
  options.compress = false !== options.compress;

  if ('closing' !== this.readyState &amp;&amp; 'closed' !== this.readyState) {
    debug('sending packet "%s" (%s)', type, data);

    var packet = {
      type: type,
      options: options
    };
    if (data) packet.data = data;

    // exports packetCreate event
    this.emit('packetCreate', packet);

    this.writeBuffer.push(packet);

    // add send callback to object, if defined
    if (callback) this.packetsFn.push(callback);

    this.flush();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.setPingTimeout" id="apidoc.element.engine.io.Socket.prototype.setPingTimeout">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>setPingTimeout
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setPingTimeout = function () {
  var self = this;
  clearTimeout(self.pingTimeoutTimer);
  self.pingTimeoutTimer = setTimeout(function () {
    self.onClose('ping timeout');
  }, self.server.pingInterval + self.server.pingTimeout);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.setTransport" id="apidoc.element.engine.io.Socket.prototype.setTransport">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>setTransport
        <span class="apidocSignatureSpan">(transport)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setTransport = function (transport) {
  var onError = this.onError.bind(this);
  var onPacket = this.onPacket.bind(this);
  var flush = this.flush.bind(this);
  var onClose = this.onClose.bind(this, 'transport close');

  this.transport = transport;
  this.transport.once('error', onError);
  this.transport.on('packet', onPacket);
  this.transport.on('drain', flush);
  this.transport.once('close', onClose);
  // this function will manage packet events (also message callbacks)
  this.setupSendCallback();

  this.cleanupFn.push(function () {
    transport.removeListener('error', onError);
    transport.removeListener('packet', onPacket);
    transport.removeListener('drain', flush);
    transport.removeListener('close', onClose);
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.setupSendCallback" id="apidoc.element.engine.io.Socket.prototype.setupSendCallback">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>setupSendCallback
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setupSendCallback = function () {
  var self = this;
  this.transport.on('drain', onDrain);

  this.cleanupFn.push(function () {
    self.transport.removeListener('drain', onDrain);
  });

  // the message was sent successfully, execute the callback
  function onDrain () {
    if (self.sentCallbackFn.length &gt; 0) {
      var seqFn = self.sentCallbackFn.splice(0, 1)[0];
      if ('function' === typeof seqFn) {
        debug('executing send callback');
        seqFn(self.transport);
      } else if (Array.isArray(seqFn)) {
        debug('executing batch send callback');
        for (var l = seqFn.length, i = 0; i &lt; l; i++) {
          if ('function' === typeof seqFn[i]) {
            seqFn[i](self.transport);
          }
        }
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Socket.prototype.write" id="apidoc.element.engine.io.Socket.prototype.write">
        function <span class="apidocSignatureSpan">engine.io.Socket.prototype.</span>write
        <span class="apidocSignatureSpan">(data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (data, options, callback) {
  this.sendPacket('message', data, options, callback);
  return this;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 }

 var self = this;
 parser.encodePayload(packets, this.supportsBinary, function (data) {
   var compress = packets.some(function (packet) {
     return packet.options &amp;&amp; packet.options.compress;
   });
   self.<span class="apidocCodeKeywordSpan">write</span>(data, { compress: compress });
 });
};

/**
* Writes data as response to poll request.
*
* @param {String} data
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.Transport" id="apidoc.module.engine.io.Transport">module engine.io.Transport</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.Transport.Transport" id="apidoc.element.engine.io.Transport.Transport">
        function <span class="apidocSignatureSpan">engine.io.</span>Transport
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Transport(req) {
  this.readyState = 'open';
  this.discarded = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.super_" id="apidoc.element.engine.io.Transport.super_">
        function <span class="apidocSignatureSpan">engine.io.Transport.</span>super_
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function EventEmitter() {
  EventEmitter.init.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.Transport.prototype" id="apidoc.module.engine.io.Transport.prototype">module engine.io.Transport.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.close" id="apidoc.element.engine.io.Transport.prototype.close">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>close
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">close = function (fn) {
  if ('closed' === this.readyState || 'closing' === this.readyState) return;

  this.readyState = 'closing';
  this.doClose(fn || noop);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.discard" id="apidoc.element.engine.io.Transport.prototype.discard">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>discard
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">discard = function () {
  this.discarded = true;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.onClose" id="apidoc.element.engine.io.Transport.prototype.onClose">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onClose
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onClose = function () {
  this.readyState = 'closed';
  this.emit('close');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Polling.prototype.onData = function (data) {
debug('received "%s"', data);
var self = this;
var callback = function (packet) {
  if ('close' === packet.type) {
    debug('got xhr close packet');
    self.<span class="apidocCodeKeywordSpan">onClose</span>();
    return false;
  }

  self.onPacket(packet);
};

parser.decodePayload(data, callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.onData" id="apidoc.element.engine.io.Transport.prototype.onData">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onData = function (data) {
  this.onPacket(parser.decodePacket(data));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (contentLength &gt; self.maxHttpBufferSize) {
  chunks = '';
  req.connection.destroy();
}
  }

  function onEnd () {
self.<span class="apidocCodeKeywordSpan">onData</span>(chunks);

var headers = {
  // text/html is required instead of text/plain to avoid an
  // unwanted download dialog on certain user-agents (GH-43)
  'Content-Type': 'text/html',
  'Content-Length': 2
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.onError" id="apidoc.element.engine.io.Transport.prototype.onError">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onError
        <span class="apidocSignatureSpan">(msg, desc)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onError = function (msg, desc) {
  if (this.listeners('error').length) {
    var err = new Error(msg);
    err.type = 'TransportError';
    err.description = desc;
    this.emit('error', err);
  } else {
    debug('ignored transport error %s (%s)', msg, desc);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api private
 */

Polling.prototype.onPollRequest = function (req, res) {
if (this.req) {
  debug('request overlap');
  // assert: this.res, '.req and .res should be (un)set together'
  this.<span class="apidocCodeKeywordSpan">onError</span>('overlap from client');
  res.writeHead(500);
  res.end();
  return;
}

debug('setting request');
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.onPacket" id="apidoc.element.engine.io.Transport.prototype.onPacket">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onPacket
        <span class="apidocSignatureSpan">(packet)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onPacket = function (packet) {
  this.emit('packet', packet);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 var callback = function (packet) {
   if ('close' === packet.type) {
     debug('got xhr close packet');
     self.onClose();
     return false;
   }

   self.<span class="apidocCodeKeywordSpan">onPacket</span>(packet);
 };

 parser.decodePayload(data, callback);
};

/**
* Overrides onClose.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.Transport.prototype.onRequest" id="apidoc.element.engine.io.Transport.prototype.onRequest">
        function <span class="apidocSignatureSpan">engine.io.Transport.prototype.</span>onRequest
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onRequest = function (req) {
  debug('setting request');
  this.req = req;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.index" id="apidoc.module.engine.io.index">module engine.io.index</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.index.index" id="apidoc.element.engine.io.index.index">
        function <span class="apidocSignatureSpan">engine.io.</span>index
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">index = function () {
  // backwards compatible use as `.attach`
  // if first argument is an http server
  if (arguments.length &amp;&amp; arguments[0] instanceof http.Server) {
    return attach.apply(this, arguments);
  }

  // if first argument is not an http server, then just make a regular eio server
  return exports.Server.apply(null, arguments);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.index.Server" id="apidoc.element.engine.io.index.Server">
        function <span class="apidocSignatureSpan">engine.io.index.</span>Server
        <span class="apidocSignatureSpan">(opts)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Server(opts) {
  if (!(this instanceof Server)) {
    return new Server(opts);
  }

  this.clients = {};
  this.clientsCount = 0;

  opts = opts || {};

  this.wsEngine = opts.wsEngine || process.env.EIO_WS_ENGINE || 'uws';
  this.pingTimeout = opts.pingTimeout || 60000;
  this.pingInterval = opts.pingInterval || 25000;
  this.upgradeTimeout = opts.upgradeTimeout || 10000;
  this.maxHttpBufferSize = opts.maxHttpBufferSize || 10E7;
  this.transports = opts.transports || Object.keys(transports);
  this.allowUpgrades = false !== opts.allowUpgrades;
  this.allowRequest = opts.allowRequest;
  this.cookie = false !== opts.cookie ? (opts.cookie || 'io') : false;
  this.cookiePath = false !== opts.cookiePath ? (opts.cookiePath || '/') : false;
  this.cookieHttpOnly = false !== opts.cookieHttpOnly;
  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || true) : false;
  this.httpCompression = false !== opts.httpCompression ? (opts.httpCompression || {}) : false;
  this.initialPacket = opts.initialPacket;

  var self = this;

  // initialize compression options
  ['perMessageDeflate', 'httpCompression'].forEach(function (type) {
    var compression = self[type];
    if (true === compression) self[type] = compression = {};
    if (compression &amp;&amp; null == compression.threshold) {
      compression.threshold = 1024;
    }
  });

  this.init();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
});
```

#### (C) Passing in requests

```js
var engine = require('engine.io');
var server = new engine.<span class="apidocCodeKeywordSpan">Server</span>();

server.on('connection', function(socket){
  socket.send('hi');
});

// â€¦
httpServer.on('upgrade', function(req, socket, head){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.index.Socket" id="apidoc.element.engine.io.index.Socket">
        function <span class="apidocSignatureSpan">engine.io.index.</span>Socket
        <span class="apidocSignatureSpan">(id, server, transport, req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Socket(id, server, transport, req) {
  this.id = id;
  this.server = server;
  this.upgrading = false;
  this.upgraded = false;
  this.readyState = 'opening';
  this.writeBuffer = [];
  this.packetsFn = [];
  this.sentCallbackFn = [];
  this.cleanupFn = [];
  this.request = req;

  // Cache IP since it might not be in the req later
  this.remoteAddress = req.connection.remoteAddress;

  this.checkIntervalTimer = null;
  this.upgradeTimeoutTimer = null;
  this.pingTimeoutTimer = null;

  this.setTransport(transport);
  this.onOpen();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

### Client

```html
&lt;script src="/path/to/engine.io.js"&gt;&lt;/script&gt;
&lt;script&gt;
  var socket = new eio.<span class="apidocCodeKeywordSpan">Socket</span>('ws://localhost/');
  socket.on('open', function(){
    socket.on('message', function(data){});
    socket.on('close', function(){});
  });
&lt;/script&gt;
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.index.Transport" id="apidoc.element.engine.io.index.Transport">
        function <span class="apidocSignatureSpan">engine.io.index.</span>Transport
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Transport(req) {
  this.readyState = 'open';
  this.discarded = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.index.attach" id="apidoc.element.engine.io.index.attach">
        function <span class="apidocSignatureSpan">engine.io.index.</span>attach
        <span class="apidocSignatureSpan">(server, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function attach(server, options) {
  var engine = new exports.Server(options);
  engine.attach(server, options);
  return engine;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
```

#### (B) Intercepting requests for a http.Server

```js
var engine = require('engine.io');
var http = require('http').createServer().listen(3000);
var server = engine.<span class="apidocCodeKeywordSpan">attach</span>(http);

server.on('connection', function (socket) {
  socket.on('message', function(data){ });
  socket.on('close', function(){ });
});
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.index.listen" id="apidoc.element.engine.io.index.listen">
        function <span class="apidocSignatureSpan">engine.io.index.</span>listen
        <span class="apidocSignatureSpan">(port, options, fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function listen(port, options, fn) {
  if ('function' === typeof options) {
    fn = options;
    options = {};
  }

  var server = http.createServer(function (req, res) {
    res.writeHead(501);
    res.end('Not Implemented');
  });

  // create engine server
  var engine = exports.attach(server, options);
  engine.httpServer = server;

  server.listen(port, fn);

  return engine;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

### Server

#### (A) Listening on a port

```js
var engine = require('engine.io');
var server = engine.<span class="apidocCodeKeywordSpan">listen</span>(80);

server.on('connection', function(socket){
  socket.send('utf 8 string');
  socket.send(new Buffer([0, 1, 2, 3, 4, 5])); // binary data
});
```
...</pre></li>
    </ul>








</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.parser" id="apidoc.module.engine.io.parser">module engine.io.parser</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.parser.decodeBase64Packet" id="apidoc.element.engine.io.parser.decodeBase64Packet">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>decodeBase64Packet
        <span class="apidocSignatureSpan">(msg, binaryType)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decodeBase64Packet = function (msg, binaryType) {
  var type = packetslist[msg.charAt(0)];
  var data = new Buffer(msg.substr(1), 'base64');
  if (binaryType === 'arraybuffer') {
    var abv = new Uint8Array(data.length);
    for (var i = 0; i &lt; abv.length; i++){
      abv[i] = data[i];
    }
    data = abv.buffer;
  }
  return { type: type, data: data };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.decodePacket" id="apidoc.element.engine.io.parser.decodePacket">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>decodePacket
        <span class="apidocSignatureSpan">(data, binaryType, utf8decode)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decodePacket = function (data, binaryType, utf8decode) {
  if (data === undefined) {
    return err;
  }

  var type;

  // String data
  if (typeof data === 'string') {

    type = data.charAt(0);

    if (type === 'b') {
      return exports.decodeBase64Packet(data.substr(1), binaryType);
    }

    if (utf8decode) {
      data = tryDecode(data);
      if (data === false) {
        return err;
      }
    }

    if (Number(type) != type || !packetslist[type]) {
      return err;
    }

    if (data.length &gt; 1) {
      return { type: packetslist[type], data: data.substring(1) };
    } else {
      return { type: packetslist[type] };
    }
  }

  // Binary data
  if (binaryType === 'arraybuffer') {
    // wrap Buffer/ArrayBuffer data into an Uint8Array
    var intArray = new Uint8Array(data);
    type = intArray[0];
    return { type: packetslist[type], data: intArray.buffer.slice(1) };
  }

  if (data instanceof ArrayBuffer) {
    data = arrayBufferToBuffer(data);
  }
  type = data[0];
  return { type: packetslist[type], data: data.slice(1) };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.decodePayload" id="apidoc.element.engine.io.parser.decodePayload">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>decodePayload
        <span class="apidocSignatureSpan">(data, binaryType, utf8decode, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decodePayload = function (data, binaryType, utf8decode, callback) {
  if (typeof data !== 'string') {
    return exports.decodePayloadAsBinary(data, binaryType, callback);
  }

  if (typeof binaryType === 'function') {
    callback = binaryType;
    binaryType = null;
  }

  if (typeof utf8decode === 'function') {
    callback = utf8decode;
    utf8decode = null;
  }

  if (data === '') {
    // parser error - ignoring payload
    return callback(err, 0, 1);
  }

  if (utf8decode) {
    data = tryDecode(data);
    if (data === false) {
      return callback(err, 0, 1);
    }
  }

  var length = '', n, msg, packet;

  for (var i = 0, l = data.length; i &lt; l; i++) {
    var chr = data.charAt(i);

    if (chr !== ':') {
      length += chr;
      continue;
    }

    if (length === '' || (length != (n = Number(length)))) {
      // parser error - ignoring payload
      return callback(err, 0, 1);
    }

    msg = data.substr(i + 1, n);

    if (length != msg.length) {
      // parser error - ignoring payload
      return callback(err, 0, 1);
    }

    if (msg.length) {
      packet = exports.decodePacket(msg, binaryType, false);

      if (err.type === packet.type &amp;&amp; err.data === packet.data) {
        // parser error in individual packet - ignoring payload
        return callback(err, 0, 1);
      }

      var more = callback(packet, i + n, l);
      if (false === more) return;
    }

    // advance cursor
    i += n;
    length = '';
  }

  if (length !== '') {
    // parser error - ignoring payload
    return callback(err, 0, 1);
  }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
     self.onClose();
     return false;
   }

   self.onPacket(packet);
 };

 parser.<span class="apidocCodeKeywordSpan">decodePayload</span>(data, callback);
};

/**
* Overrides onClose.
*
* @api private
*/
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.decodePayloadAsBinary" id="apidoc.element.engine.io.parser.decodePayloadAsBinary">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>decodePayloadAsBinary
        <span class="apidocSignatureSpan">(data, binaryType, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">decodePayloadAsBinary = function (data, binaryType, callback) {
  if (typeof binaryType === 'function') {
    callback = binaryType;
    binaryType = null;
  }

  var bufferTail = data;
  var buffers = [];
  var i;

  while (bufferTail.length &gt; 0) {
    var strLen = '';
    var isString = bufferTail[0] === 0;
    for (i = 1; ; i++) {
      if (bufferTail[i] === 255)  break;
      // 310 = char length of Number.MAX_VALUE
      if (strLen.length &gt; 310) {
        return callback(err, 0, 1);
      }
      strLen += '' + bufferTail[i];
    }
    bufferTail = bufferTail.slice(strLen.length + 1);

    var msgLength = parseInt(strLen, 10);

    var msg = bufferTail.slice(1, msgLength + 1);
    if (isString) msg = bufferToString(msg);
    buffers.push(msg);
    bufferTail = bufferTail.slice(msgLength + 1);
  }

  var total = buffers.length;
  for (i = 0; i &lt; total; i++) {
    var buffer = buffers[i];
    callback(exports.decodePacket(buffer, binaryType, true), i, total);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.encodeBase64Packet" id="apidoc.element.engine.io.parser.encodeBase64Packet">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>encodeBase64Packet
        <span class="apidocSignatureSpan">(packet, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encodeBase64Packet = function (packet, callback){
  if (!Buffer.isBuffer(packet.data)) {
    packet.data = arrayBufferToBuffer(packet.data);
  }

  var message = 'b' + packets[packet.type];
  message += packet.data.toString('base64');
  return callback(message);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.encodePacket" id="apidoc.element.engine.io.parser.encodePacket">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>encodePacket
        <span class="apidocSignatureSpan">(packet, supportsBinary, utf8encode, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encodePacket = function (packet, supportsBinary, utf8encode, callback) {
  if (typeof supportsBinary === 'function') {
    callback = supportsBinary;
    supportsBinary = null;
  }

  if (typeof utf8encode === 'function') {
    callback = utf8encode;
    utf8encode = null;
  }

  if (Buffer.isBuffer(packet.data)) {
    return encodeBuffer(packet, supportsBinary, callback);
  } else if (packet.data &amp;&amp; (packet.data.buffer || packet.data) instanceof ArrayBuffer) {
    packet.data = arrayBufferToBuffer(packet.data);
    return encodeBuffer(packet, supportsBinary, callback);
  }

  // Sending data as a utf-8 string
  var encoded = packets[packet.type];

  // data fragment is optional
  if (undefined !== packet.data) {
    encoded += utf8encode ? utf8.encode(String(packet.data), { strict: false }) : String(packet.data);
  }

  return callback('' + encoded);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.encodePayload" id="apidoc.element.engine.io.parser.encodePayload">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>encodePayload
        <span class="apidocSignatureSpan">(packets, supportsBinary, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encodePayload = function (packets, supportsBinary, callback) {
  if (typeof supportsBinary === 'function') {
    callback = supportsBinary;
    supportsBinary = null;
  }

  if (supportsBinary &amp;&amp; hasBinary(packets)) {
    return exports.encodePayloadAsBinary(packets, callback);
  }

  if (!packets.length) {
    return callback('0:');
  }

  function encodeOne(packet, doneCallback) {
    exports.encodePacket(packet, supportsBinary, false, function(message) {
      doneCallback(null, setLengthHeader(message));
    });
  }

  map(packets, encodeOne, function(err, results) {
    return callback(results.join(''));
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    debug('appending close packet to payload');
    packets.push({ type: 'close' });
    this.shouldClose();
    this.shouldClose = null;
  }

  var self = this;
  parser.<span class="apidocCodeKeywordSpan">encodePayload</span>(packets, this.supportsBinary, function (data) {
    var compress = packets.some(function (packet) {
      return packet.options &amp;&amp; packet.options.compress;
    });
    self.write(data, { compress: compress });
  });
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.parser.encodePayloadAsBinary" id="apidoc.element.engine.io.parser.encodePayloadAsBinary">
        function <span class="apidocSignatureSpan">engine.io.parser.</span>encodePayloadAsBinary
        <span class="apidocSignatureSpan">(packets, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">encodePayloadAsBinary = function (packets, callback) {
  if (!packets.length) {
    return callback(new Buffer(0));
  }

  map(packets, encodeOneBinaryPacket, function(err, results) {
    return callback(Buffer.concat(results));
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.polling" id="apidoc.module.engine.io.polling">module engine.io.polling</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.polling.polling" id="apidoc.element.engine.io.polling.polling">
        function <span class="apidocSignatureSpan">engine.io.</span>polling
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Polling(req) {
  Transport.call(this, req);

  this.closeTimeout = 30 * 1000;
  this.maxHttpBufferSize = null;
  this.httpCompression = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.super_" id="apidoc.element.engine.io.polling.super_">
        function <span class="apidocSignatureSpan">engine.io.polling.</span>super_
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Transport(req) {
  this.readyState = 'open';
  this.discarded = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.polling.prototype" id="apidoc.module.engine.io.polling.prototype">module engine.io.polling.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.compress" id="apidoc.element.engine.io.polling.prototype.compress">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>compress
        <span class="apidocSignatureSpan">(data, encoding, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">compress = function (data, encoding, callback) {
  debug('compressing');

  var buffers = [];
  var nread = 0;

  compressionMethods[encoding](this.httpCompression)
    .on('error', callback)
    .on('data', function (chunk) {
      buffers.push(chunk);
      nread += chunk.length;
    })
    .on('end', function () {
      callback(null, Buffer.concat(buffers, nread));
    })
    .end(data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

var encoding = accepts(this.req).encodings(['gzip', 'deflate']);
if (!encoding) {
  respond(data);
  return;
}

this.<span class="apidocCodeKeywordSpan">compress</span>(data, encoding, function (err, data) {
  if (err) {
    self.res.writeHead(500);
    self.res.end();
    callback(err);
    return;
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.doClose" id="apidoc.element.engine.io.polling.prototype.doClose">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>doClose
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">doClose = function (fn) {
  debug('closing');

  var self = this;
  var closeTimeoutTimer;

  if (this.dataReq) {
    debug('aborting ongoing data request');
    this.dataReq.destroy();
  }

  if (this.writable) {
    debug('transport writable - closing right away');
    this.send([{ type: 'close' }]);
    onClose();
  } else if (this.discarded) {
    debug('transport discarded - closing right away');
    onClose();
  } else {
    debug('transport not writable - buffering orderly close');
    this.shouldClose = onClose;
    closeTimeoutTimer = setTimeout(onClose, this.closeTimeout);
  }

  function onClose () {
    clearTimeout(closeTimeoutTimer);
    fn();
    self.onClose();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.doWrite" id="apidoc.element.engine.io.polling.prototype.doWrite">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>doWrite
        <span class="apidocSignatureSpan">(data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">doWrite = function (data, options, callback) {
  var self = this;

  // explicit UTF-8 is required for pages not served under utf
  var isString = typeof data === 'string';
  var contentType = isString
    ? 'text/plain; charset=UTF-8'
    : 'application/octet-stream';

  var headers = {
    'Content-Type': contentType
  };

  if (!this.httpCompression || !options.compress) {
    respond(data);
    return;
  }

  var len = isString ? Buffer.byteLength(data) : data.length;
  if (len &lt; this.httpCompression.threshold) {
    respond(data);
    return;
  }

  var encoding = accepts(this.req).encodings(['gzip', 'deflate']);
  if (!encoding) {
    respond(data);
    return;
  }

  this.compress(data, encoding, function (err, data) {
    if (err) {
      self.res.writeHead(500);
      self.res.end();
      callback(err);
      return;
    }

    headers['Content-Encoding'] = encoding;
    respond(data);
  });

  function respond (data) {
    headers['Content-Length'] = 'string' === typeof data ? Buffer.byteLength(data) : data.length;
    self.res.writeHead(200, self.headers(self.req, headers));
    self.res.end(data);
    callback();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {Object} options
* @api private
*/

Polling.prototype.write = function (data, options) {
 debug('writing "%s"', data);
 var self = this;
 this.<span class="apidocCodeKeywordSpan">doWrite</span>(data, options, function () {
   self.req.cleanup();
 });
};

/**
* Performs the write.
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.headers" id="apidoc.element.engine.io.polling.prototype.headers">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>headers
        <span class="apidocSignatureSpan">(req, headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">headers = function (req, headers) {
  headers = headers || {};

  // prevent XSS warnings on IE
  // https://github.com/LearnBoost/socket.io/pull/1333
  var ua = req.headers['user-agent'];
  if (ua &amp;&amp; (~ua.indexOf(';MSIE') || ~ua.indexOf('Trident/'))) {
    headers['X-XSS-Protection'] = '0';
  }

  this.emit('headers', headers);
  return headers;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var headers = {
    // text/html is required instead of text/plain to avoid an
    // unwanted download dialog on certain user-agents (GH-43)
    'Content-Type': 'text/html',
    'Content-Length': 2
  };

  res.writeHead(200, self.<span class="apidocCodeKeywordSpan">headers</span>(req, headers));
  res.end('ok');
  cleanup();
}

req.on('close', onClose);
if (!isBinary) req.setEncoding('utf8');
req.on('data', onData);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.onClose" id="apidoc.element.engine.io.polling.prototype.onClose">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onClose
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onClose = function () {
  if (this.writable) {
    // close pending poll request
    this.send([{ type: 'noop' }]);
  }
  Transport.prototype.onClose.call(this);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Polling.prototype.onData = function (data) {
debug('received "%s"', data);
var self = this;
var callback = function (packet) {
  if ('close' === packet.type) {
    debug('got xhr close packet');
    self.<span class="apidocCodeKeywordSpan">onClose</span>();
    return false;
  }

  self.onPacket(packet);
};

parser.decodePayload(data, callback);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.onData" id="apidoc.element.engine.io.polling.prototype.onData">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onData = function (data) {
  debug('received "%s"', data);
  var self = this;
  var callback = function (packet) {
    if ('close' === packet.type) {
      debug('got xhr close packet');
      self.onClose();
      return false;
    }

    self.onPacket(packet);
  };

  parser.decodePayload(data, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (contentLength &gt; self.maxHttpBufferSize) {
  chunks = '';
  req.connection.destroy();
}
  }

  function onEnd () {
self.<span class="apidocCodeKeywordSpan">onData</span>(chunks);

var headers = {
  // text/html is required instead of text/plain to avoid an
  // unwanted download dialog on certain user-agents (GH-43)
  'Content-Type': 'text/html',
  'Content-Length': 2
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.onDataRequest" id="apidoc.element.engine.io.polling.prototype.onDataRequest">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onDataRequest
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onDataRequest = function (req, res) {
  if (this.dataReq) {
    // assert: this.dataRes, '.dataReq and .dataRes should be (un)set together'
    this.onError('data request overlap from client');
    res.writeHead(500);
    res.end();
    return;
  }

  var isBinary = 'application/octet-stream' === req.headers['content-type'];

  this.dataReq = req;
  this.dataRes = res;

  var chunks = isBinary ? new Buffer(0) : '';
  var self = this;

  function cleanup () {
    chunks = isBinary ? new Buffer(0) : '';
    req.removeListener('data', onData);
    req.removeListener('end', onEnd);
    req.removeListener('close', onClose);
    self.dataReq = self.dataRes = null;
  }

  function onClose () {
    cleanup();
    self.onError('data request connection closed prematurely');
  }

  function onData (data) {
    var contentLength;
    if (typeof data === 'string') {
      chunks += data;
      contentLength = Buffer.byteLength(chunks);
    } else {
      chunks = Buffer.concat([chunks, data]);
      contentLength = chunks.length;
    }

    if (contentLength &gt; self.maxHttpBufferSize) {
      chunks = '';
      req.connection.destroy();
    }
  }

  function onEnd () {
    self.onData(chunks);

    var headers = {
      // text/html is required instead of text/plain to avoid an
      // unwanted download dialog on certain user-agents (GH-43)
      'Content-Type': 'text/html',
      'Content-Length': 2
    };

    res.writeHead(200, self.headers(req, headers));
    res.end('ok');
    cleanup();
  }

  req.on('close', onClose);
  if (!isBinary) req.setEncoding('utf8');
  req.on('data', onData);
  req.on('end', onEnd);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Polling.prototype.onRequest = function (req) {
  var res = req.res;

  if ('GET' === req.method) {
    this.onPollRequest(req, res);
  } else if ('POST' === req.method) {
    this.<span class="apidocCodeKeywordSpan">onDataRequest</span>(req, res);
  } else {
    res.writeHead(500);
    res.end();
  }
};

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.onPollRequest" id="apidoc.element.engine.io.polling.prototype.onPollRequest">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onPollRequest
        <span class="apidocSignatureSpan">(req, res)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onPollRequest = function (req, res) {
  if (this.req) {
    debug('request overlap');
    // assert: this.res, '.req and .res should be (un)set together'
    this.onError('overlap from client');
    res.writeHead(500);
    res.end();
    return;
  }

  debug('setting request');

  this.req = req;
  this.res = res;

  var self = this;

  function onClose () {
    self.onError('poll connection closed prematurely');
  }

  function cleanup () {
    req.removeListener('close', onClose);
    self.req = self.res = null;
  }

  req.cleanup = cleanup;
  req.on('close', onClose);

  this.writable = true;
  this.emit('drain');

  // if we're still writable but had a pending close, trigger an empty send
  if (this.writable &amp;&amp; this.shouldClose) {
    debug('triggering empty send to append close packet');
    this.send([{ type: 'noop' }]);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @api private
 */

Polling.prototype.onRequest = function (req) {
  var res = req.res;

  if ('GET' === req.method) {
    this.<span class="apidocCodeKeywordSpan">onPollRequest</span>(req, res);
  } else if ('POST' === req.method) {
    this.onDataRequest(req, res);
  } else {
    res.writeHead(500);
    res.end();
  }
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.onRequest" id="apidoc.element.engine.io.polling.prototype.onRequest">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>onRequest
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onRequest = function (req) {
  var res = req.res;

  if ('GET' === req.method) {
    this.onPollRequest(req, res);
  } else if ('POST' === req.method) {
    this.onDataRequest(req, res);
  } else {
    res.writeHead(500);
    res.end();
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.send" id="apidoc.element.engine.io.polling.prototype.send">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>send
        <span class="apidocSignatureSpan">(packets)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (packets) {
  this.writable = false;

  if (this.shouldClose) {
    debug('appending close packet to payload');
    packets.push({ type: 'close' });
    this.shouldClose();
    this.shouldClose = null;
  }

  var self = this;
  parser.encodePayload(packets, this.supportsBinary, function (data) {
    var compress = packets.some(function (packet) {
      return packet.options &amp;&amp; packet.options.compress;
    });
    self.write(data, { compress: compress });
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
#### (A) Listening on a port

```js
var engine = require('engine.io');
var server = engine.listen(80);

server.on('connection', function(socket){
  socket.<span class="apidocCodeKeywordSpan">send</span>('utf 8 string');
  socket.send(new Buffer([0, 1, 2, 3, 4, 5])); // binary data
});
```

#### (B) Intercepting requests for a http.Server

```js
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling.prototype.write" id="apidoc.element.engine.io.polling.prototype.write">
        function <span class="apidocSignatureSpan">engine.io.polling.prototype.</span>write
        <span class="apidocSignatureSpan">(data, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (data, options) {
  debug('writing "%s"', data);
  var self = this;
  this.doWrite(data, options, function () {
    self.req.cleanup();
  });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 }

 var self = this;
 parser.encodePayload(packets, this.supportsBinary, function (data) {
   var compress = packets.some(function (packet) {
     return packet.options &amp;&amp; packet.options.compress;
   });
   self.<span class="apidocCodeKeywordSpan">write</span>(data, { compress: compress });
 });
};

/**
* Writes data as response to poll request.
*
* @param {String} data
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.polling_jsonp" id="apidoc.module.engine.io.polling_jsonp">module engine.io.polling_jsonp</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.polling_jsonp.polling_jsonp" id="apidoc.element.engine.io.polling_jsonp.polling_jsonp">
        function <span class="apidocSignatureSpan">engine.io.</span>polling_jsonp
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function JSONP(req) {
  Polling.call(this, req);

  this.head = '___eio[' + (req._query.j || '').replace(/[^0-9]/g, '') + '](';
  this.foot = ');';
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling_jsonp.super_" id="apidoc.element.engine.io.polling_jsonp.super_">
        function <span class="apidocSignatureSpan">engine.io.polling_jsonp.</span>super_
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Polling(req) {
  Transport.call(this, req);

  this.closeTimeout = 30 * 1000;
  this.maxHttpBufferSize = null;
  this.httpCompression = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.polling_jsonp.prototype" id="apidoc.module.engine.io.polling_jsonp.prototype">module engine.io.polling_jsonp.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.polling_jsonp.prototype.doWrite" id="apidoc.element.engine.io.polling_jsonp.prototype.doWrite">
        function <span class="apidocSignatureSpan">engine.io.polling_jsonp.prototype.</span>doWrite
        <span class="apidocSignatureSpan">(data, options, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">doWrite = function (data, options, callback) {
  // we must output valid javascript, not valid json
  // see: http://timelessrepo.com/json-isnt-a-javascript-subset
  var js = JSON.stringify(data)
    .replace(/\u2028/g, '\\u2028')
    .replace(/\u2029/g, '\\u2029');

  // prepare response
  data = this.head + js + this.foot;

  Polling.prototype.doWrite.call(this, data, options, callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
* @param {Object} options
* @api private
*/

Polling.prototype.write = function (data, options) {
 debug('writing "%s"', data);
 var self = this;
 this.<span class="apidocCodeKeywordSpan">doWrite</span>(data, options, function () {
   self.req.cleanup();
 });
};

/**
* Performs the write.
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling_jsonp.prototype.onData" id="apidoc.element.engine.io.polling_jsonp.prototype.onData">
        function <span class="apidocSignatureSpan">engine.io.polling_jsonp.prototype.</span>onData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onData = function (data) {
  // we leverage the qs module so that we get built-in DoS protection
  // and the fast alternative to decodeURIComponent
  data = qs.parse(data).d;
  if ('string' === typeof data) {
    // client will send already escaped newlines as \\\\n and newlines as \\n
    // \\n must be replaced with \n and \\\\n with \\n
    data = data.replace(rSlashes, function (match, slashes) {
      return slashes ? match : '\n';
    });
    Polling.prototype.onData.call(this, data.replace(rDoubleSlashes, '\\n'));
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (contentLength &gt; self.maxHttpBufferSize) {
  chunks = '';
  req.connection.destroy();
}
  }

  function onEnd () {
self.<span class="apidocCodeKeywordSpan">onData</span>(chunks);

var headers = {
  // text/html is required instead of text/plain to avoid an
  // unwanted download dialog on certain user-agents (GH-43)
  'Content-Type': 'text/html',
  'Content-Length': 2
};
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.polling_xhr" id="apidoc.module.engine.io.polling_xhr">module engine.io.polling_xhr</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.polling_xhr.polling_xhr" id="apidoc.element.engine.io.polling_xhr.polling_xhr">
        function <span class="apidocSignatureSpan">engine.io.</span>polling_xhr
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function XHR(req) {
  Polling.call(this, req);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling_xhr.super_" id="apidoc.element.engine.io.polling_xhr.super_">
        function <span class="apidocSignatureSpan">engine.io.polling_xhr.</span>super_
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Polling(req) {
  Transport.call(this, req);

  this.closeTimeout = 30 * 1000;
  this.maxHttpBufferSize = null;
  this.httpCompression = null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.polling_xhr.prototype" id="apidoc.module.engine.io.polling_xhr.prototype">module engine.io.polling_xhr.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.polling_xhr.prototype.headers" id="apidoc.element.engine.io.polling_xhr.prototype.headers">
        function <span class="apidocSignatureSpan">engine.io.polling_xhr.prototype.</span>headers
        <span class="apidocSignatureSpan">(req, headers)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">headers = function (req, headers) {
  headers = headers || {};

  if (req.headers.origin) {
    headers['Access-Control-Allow-Credentials'] = 'true';
    headers['Access-Control-Allow-Origin'] = req.headers.origin;
  } else {
    headers['Access-Control-Allow-Origin'] = '*';
  }

  return Polling.prototype.headers.call(this, req, headers);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var headers = {
    // text/html is required instead of text/plain to avoid an
    // unwanted download dialog on certain user-agents (GH-43)
    'Content-Type': 'text/html',
    'Content-Length': 2
  };

  res.writeHead(200, self.<span class="apidocCodeKeywordSpan">headers</span>(req, headers));
  res.end('ok');
  cleanup();
}

req.on('close', onClose);
if (!isBinary) req.setEncoding('utf8');
req.on('data', onData);
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.polling_xhr.prototype.onRequest" id="apidoc.element.engine.io.polling_xhr.prototype.onRequest">
        function <span class="apidocSignatureSpan">engine.io.polling_xhr.prototype.</span>onRequest
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onRequest = function (req) {
  if ('OPTIONS' === req.method) {
    var res = req.res;
    var headers = this.headers(req);
    headers['Access-Control-Allow-Headers'] = 'Content-Type';
    res.writeHead(200, headers);
    res.end();
  } else {
    Polling.prototype.onRequest.call(this, req);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.transports" id="apidoc.module.engine.io.transports">module engine.io.transports</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.transports.polling" id="apidoc.element.engine.io.transports.polling">
        function <span class="apidocSignatureSpan">engine.io.transports.</span>polling
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function polling(req) {
  if ('string' === typeof req._query.j) {
    return new JSONP(req);
  } else {
    return new XHR(req);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.transports.websocket" id="apidoc.element.engine.io.transports.websocket">
        function <span class="apidocSignatureSpan">engine.io.transports.</span>websocket
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function WebSocket(req) {
  Transport.call(this, req);
  var self = this;
  this.socket = req.websocket;
  this.socket.on('message', this.onData.bind(this));
  this.socket.once('close', this.onClose.bind(this));
  this.socket.on('error', this.onError.bind(this));
  this.socket.on('headers', onHeaders);
  this.writable = true;
  this.perMessageDeflate = null;

  function onHeaders (headers) {
    self.emit('headers', headers);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.transports.websocket" id="apidoc.module.engine.io.transports.websocket">module engine.io.transports.websocket</a></h1>


    <h2>
        <a href="#apidoc.element.engine.io.transports.websocket.websocket" id="apidoc.element.engine.io.transports.websocket.websocket">
        function <span class="apidocSignatureSpan">engine.io.transports.</span>websocket
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function WebSocket(req) {
  Transport.call(this, req);
  var self = this;
  this.socket = req.websocket;
  this.socket.on('message', this.onData.bind(this));
  this.socket.once('close', this.onClose.bind(this));
  this.socket.on('error', this.onError.bind(this));
  this.socket.on('headers', onHeaders);
  this.writable = true;
  this.perMessageDeflate = null;

  function onHeaders (headers) {
    self.emit('headers', headers);
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.transports.websocket.super_" id="apidoc.element.engine.io.transports.websocket.super_">
        function <span class="apidocSignatureSpan">engine.io.transports.websocket.</span>super_
        <span class="apidocSignatureSpan">(req)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Transport(req) {
  this.readyState = 'open';
  this.discarded = false;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.engine.io.transports.websocket.prototype" id="apidoc.module.engine.io.transports.websocket.prototype">module engine.io.transports.websocket.prototype</a></h1>






    <h2>
        <a href="#apidoc.element.engine.io.transports.websocket.prototype.doClose" id="apidoc.element.engine.io.transports.websocket.prototype.doClose">
        function <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>doClose
        <span class="apidocSignatureSpan">(fn)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">doClose = function (fn) {
  debug('closing');
  this.socket.close();
  fn &amp;&amp; fn();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.transports.websocket.prototype.onData" id="apidoc.element.engine.io.transports.websocket.prototype.onData">
        function <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>onData
        <span class="apidocSignatureSpan">(data)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">onData = function (data) {
  debug('received "%s"', data);
  Transport.prototype.onData.call(this, data);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
if (contentLength &gt; self.maxHttpBufferSize) {
  chunks = '';
  req.connection.destroy();
}
  }

  function onEnd () {
self.<span class="apidocCodeKeywordSpan">onData</span>(chunks);

var headers = {
  // text/html is required instead of text/plain to avoid an
  // unwanted download dialog on certain user-agents (GH-43)
  'Content-Type': 'text/html',
  'Content-Length': 2
};
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.engine.io.transports.websocket.prototype.send" id="apidoc.element.engine.io.transports.websocket.prototype.send">
        function <span class="apidocSignatureSpan">engine.io.transports.websocket.prototype.</span>send
        <span class="apidocSignatureSpan">(packets)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">send = function (packets) {
  var self = this;

  for (var i = 0; i &lt; packets.length; i++) {
    var packet = packets[i];
    parser.encodePacket(packet, self.supportsBinary, send);
  }

  function send (data) {
    debug('writing "%s"', data);

    // always creates a new object since ws modifies it
    var opts = {};
    if (packet.options) {
      opts.compress = packet.options.compress;
    }

    if (self.perMessageDeflate) {
      var len = 'string' === typeof data ? Buffer.byteLength(data) : data.length;
      if (len &lt; self.perMessageDeflate.threshold) {
        opts.compress = false;
      }
    }

    self.writable = false;
    self.socket.send(data, opts, onEnd);
  }

  function onEnd (err) {
    if (err) return self.onError('write error', err.stack);
    self.writable = true;
    self.emit('drain');
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
#### (A) Listening on a port

```js
var engine = require('engine.io');
var server = engine.listen(80);

server.on('connection', function(socket){
  socket.<span class="apidocCodeKeywordSpan">send</span>('utf 8 string');
  socket.send(new Buffer([0, 1, 2, 3, 4, 5])); // binary data
});
```

#### (B) Intercepting requests for a http.Server

```js
...</pre></li>
    </ul>




</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>